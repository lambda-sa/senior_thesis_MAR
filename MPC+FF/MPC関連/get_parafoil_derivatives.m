function f_sys = get_parafoil_derivatives(in1,in2,in3)
%GET_PARAFOIL_DERIVATIVES
%    F_SYS = GET_PARAFOIL_DERIVATIVES(IN1,IN2,IN3)

%    This function was generated by the Symbolic Math Toolbox version 25.2.
%    24-Dec-2025 20:07:26

CD0 = in3(:,19);
CDS = in3(:,35);
CD_a2 = in3(:,20);
CD_da = in3(:,21);
CD_ds = in3(:,22);
CL0 = in3(:,23);
CL_a = in3(:,24);
CL_da = in3(:,25);
Cl_p = in3(:,30);
Cl_da = in3(:,31);
Cl_phi = in3(:,29);
Cm0 = in3(:,26);
Cm_a = in3(:,27);
Cm_q = in3(:,28);
Cn_r = in3(:,32);
Cn_da = in3(:,33);
Cy_beta = in3(:,34);
Gamma = in3(:,18);
Ixx = in3(:,2);
Ixz = in3(:,5);
Iyy = in3(:,3);
Izz = in3(:,4);
Sp = in3(:,8);
Ss = in3(:,9);
b = in3(:,10);
c = in3(:,11);
dL = in2(1,:);
dR = in2(2,:);
g = in3(:,7);
k_soft = in3(:,36);
m = in3(:,1);
p = in1(4,:);
phi = in1(7,:);
psi = in1(9,:);
q = in1(5,:);
r = in1(6,:);
rho = in3(:,6);
theta = in1(8,:);
u = in1(1,:);
v = in1(2,:);
w = in1(3,:);
x_c = in3(:,12);
x_p = in3(:,15);
y_c = in3(:,13);
y_p = in3(:,16);
z_c = in3(:,14);
z_p = in3(:,17);
et1 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et2 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et3 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et4 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et5 = q.*(Ixx.*p+Ixz.*r)+y_c.*((et1+et2).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)-(et3+et4).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c))));
et6 = -Iyy.*p.*q-(CDS.*Ss.*rho.*x_p.*(v-p.*z_p+r.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0+(CDS.*Ss.*rho.*y_p.*(u+q.*z_p-r.*y_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0;
et7 = Sp.*b.*rho.*cos(Gamma).*((Cn_da.*(dL-dR))./b-(Cn_r.*b.*(r.*cos(Gamma)+p.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0);
et8 = (Cy_beta.*Sp.*rho.*x_c.*asin((v-p.*z_c+r.*x_c).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0;
et9 = Sp.*b.*rho.*sin(Gamma).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(Cl_phi.*phi-(Cl_da.*(dL-dR))./b+(Cl_p.*b.*(p.*cos(Gamma)-r.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*(-1.0./2.0);
et10 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et11 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et12 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et13 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et14 = q.*(Ixz.*p+Izz.*r)+y_c.*((et10+et11).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)+(et12+et13).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c))));
et15 = -Iyy.*q.*r+(CDS.*Ss.*rho.*y_p.*(w+p.*y_p-q.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0-(CDS.*Ss.*rho.*z_p.*(v-p.*z_p+r.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0;
et16 = (Sp.*b.*rho.*sin(Gamma).*((Cn_da.*(dL-dR))./b-(Cn_r.*b.*(r.*cos(Gamma)+p.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0;
et17 = Sp.*b.*rho.*cos(Gamma).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(Cl_phi.*phi-(Cl_da.*(dL-dR))./b+(Cl_p.*b.*(p.*cos(Gamma)-r.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*(-1.0./2.0);
et18 = (Cy_beta.*Sp.*rho.*z_c.*asin((v-p.*z_c+r.*x_c).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0;
et19 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et20 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et21 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et22 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et23 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et24 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et25 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et26 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et27 = Sp.*c.*rho.*(Cm0+Cm_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c))+(Cm_q.*c.*q.*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0);
et28 = ((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2)./2.0;
et29 = p.*(Ixz.*p+Izz.*r)-r.*(Ixx.*p+Ixz.*r);
et30 = x_c.*((et19+et20).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)+(et21+et22).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c))));
et31 = -z_c.*((et23+et24).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)-(et25+et26).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c))))+et27.*et28;
et32 = (CDS.*Ss.*rho.*x_p.*(w+p.*y_p-q.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0-(CDS.*Ss.*rho.*z_p.*(u+q.*z_p-r.*y_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0;
et33 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et34 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et35 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et36 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et37 = q.*(Ixx.*p+Ixz.*r)+y_c.*((et33+et34).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)-(et35+et36).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c))));
et38 = -Iyy.*p.*q-(CDS.*Ss.*rho.*x_p.*(v-p.*z_p+r.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0+(CDS.*Ss.*rho.*y_p.*(u+q.*z_p-r.*y_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0;
et39 = Sp.*b.*rho.*cos(Gamma).*((Cn_da.*(dL-dR))./b-(Cn_r.*b.*(r.*cos(Gamma)+p.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0);
et40 = (Cy_beta.*Sp.*rho.*x_c.*asin((v-p.*z_c+r.*x_c).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0;
et41 = Sp.*b.*rho.*sin(Gamma).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(Cl_phi.*phi-(Cl_da.*(dL-dR))./b+(Cl_p.*b.*(p.*cos(Gamma)-r.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*(-1.0./2.0);
et42 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et43 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et44 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et45 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et46 = q.*(Ixz.*p+Izz.*r)+y_c.*((et42+et43).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)+(et44+et45).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c))));
et47 = -Iyy.*q.*r+(CDS.*Ss.*rho.*y_p.*(w+p.*y_p-q.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0-(CDS.*Ss.*rho.*z_p.*(v-p.*z_p+r.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0;
et48 = (Sp.*b.*rho.*sin(Gamma).*((Cn_da.*(dL-dR))./b-(Cn_r.*b.*(r.*cos(Gamma)+p.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0;
et49 = Sp.*b.*rho.*cos(Gamma).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(Cl_phi.*phi-(Cl_da.*(dL-dR))./b+(Cl_p.*b.*(p.*cos(Gamma)-r.*sin(Gamma)).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0).*(-1.0./2.0);
et50 = (Cy_beta.*Sp.*rho.*z_c.*asin((v-p.*z_c+r.*x_c).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0;
et51 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et52 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et53 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et54 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et55 = (et51+et52).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)+(et53+et54).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)))-g.*m.*cos(phi).*cos(theta);
et56 = (CDS.*Ss.*rho.*(w+p.*y_p-q.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0;
et57 = g.*m.*cos(theta).*sin(phi)+(Cy_beta.*Sp.*rho.*asin((v-p.*z_c+r.*x_c).*1.0./sqrt((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./2.0;
et58 = CDS.*Ss.*rho.*(v-p.*z_p+r.*x_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2).*(-1.0./2.0);
et59 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et60 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et61 = (Sp.*rho.*cos(Gamma).*(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2))./(abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i).*2.0);
et62 = (Sp.*rho.*sin(Gamma).*(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).*((cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c)).^2+(cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2+(v-p.*z_c+r.*x_c).^2).*(-1.0./2.0))./abs(cos(Gamma).*(w+p.*y_c-q.*x_c).*1i+cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c).*1i);
et63 = (et59+et60).*(CD0-CD_da.*(dL-dR)+CD_a2.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)).^2-(CD_ds.*log(exp(-dL.*k_soft)+exp(-dR.*k_soft)))./k_soft)-(et61+et62).*(CL0-CL_da.*(dL-dR)+CL_a.*atan2(cos(Gamma).*(w+p.*y_c-q.*x_c)+sin(Gamma).*(u+q.*z_c-r.*y_c),cos(Gamma).*(u+q.*z_c-r.*y_c)-sin(Gamma).*(w+p.*y_c-q.*x_c)))+g.*m.*sin(theta);
et64 = (CDS.*Ss.*rho.*(u+q.*z_p-r.*y_p).*sqrt((w+p.*y_p-q.*x_p).^2+(v-p.*z_p+r.*x_p).^2+(u+q.*z_p-r.*y_p).^2))./2.0;
mt1 = [-q.*w+r.*v-(et63+et64)./m;p.*w-r.*u+(et57+et58)./m;-p.*v+q.*u-(et55+et56)./m;(Ixz.*(et37+et38+et39+et40+et41))./(Ixz.^2-Ixx.*Izz)+(Izz.*(et46+et47+et48+et49+et50))./(Ixz.^2-Ixx.*Izz);(et29+et30+et31+et32)./Iyy;-(Ixx.*(et5+et6+et7+et8+et9))./(Ixz.^2-Ixx.*Izz)-(Ixz.*(et14+et15+et16+et17+et18))./(Ixz.^2-Ixx.*Izz);p+(r.*cos(phi).*sin(theta))./cos(theta)+(q.*sin(phi).*sin(theta))./cos(theta);q.*cos(phi)-r.*sin(phi)];
mt2 = [(r.*cos(phi))./cos(theta)+(q.*sin(phi))./cos(theta);-v.*(cos(phi).*sin(psi)-cos(psi).*sin(phi).*sin(theta))+w.*(sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+u.*cos(psi).*cos(theta);v.*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))-w.*(cos(psi).*sin(phi)-cos(phi).*sin(psi).*sin(theta))+u.*cos(theta).*sin(psi);-u.*sin(theta)+w.*cos(phi).*cos(theta)+v.*cos(theta).*sin(phi)];
f_sys = [mt1;mt2];
end
